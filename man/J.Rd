% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Variance Estimation Functions: Profile
%   Likelihood.R
\name{J}
\alias{J}
\title{Computes the Full-Data Variability Matrix}
\usage{
J(beta, lambda.list, l, u, tau, x, mapping, p, h.n)
}
\arguments{
\item{beta}{Numeric vector of length \eqn{p}. Final fixed effect estimates.}

\item{lambda.list}{List. Profile maximum likelihood estimators for the baseline hazard function under various first- and second-order perturbations of \code{beta}.}

\item{l}{List of length \eqn{S}. Each element is a numeric vector of left endpoints of censoring intervals for each stratum.}

\item{u}{List of length \eqn{S}. Each element is a numeric vector of right endpoints of censoring intervals for each stratum.}

\item{tau}{List of length \eqn{S}. Each element is a numeric vector of sorted unique timepoints for each stratum.}

\item{x}{List of length \eqn{S}. Each element is a covariate array for each stratum.}

\item{mapping}{List or \code{NULL}. Mapping between cluster indexing \eqn{(i,j)} and stratum indexing \eqn{(s,v)} for robust variance estimation. If \code{NULL}, assumes clustering and stratification are identical.}

\item{p}{Integer. Dimension of the coefficient vector \code{beta}.}

\item{h.n}{Numeric. Perturbation constant used in finite difference approximations.}
}
\value{
A \eqn{p \times p} numeric matrix representing the full-data variability matrix.
}
\description{
Calculates the variability matrix using cluster-specific contributions.
Handles both cases where the clustering and stratification variables are the same or differ.
}
\details{
This function sums cluster-specific outer products of score vectors, using either \code{J_i_1} or \code{J_i_2} depending on the relationship between clustering and stratification variables.
It restructures \code{lambda.list} for compatibility with cluster-specific functions if clustering and stratification coincide.
}
\seealso{
\code{\link{J_i_1}}, \code{\link{J_i_2}}
}
