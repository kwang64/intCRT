% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Profile Composite Log-Likelihood Function.R
\name{argmax_profile}
\alias{argmax_profile}
\title{Estimate Baseline Hazard Functions via Profile Composite Likelihood}
\usage{
argmax_profile(beta, l, u, u.star, tau, x, risk, mapping = NULL, control)
}
\arguments{
\item{beta}{Numeric vector. Current fixed effect estimates of length \eqn{p}.}

\item{l}{List of length \eqn{S}. Each element \code{l[[s]]} is a numeric vector of left endpoints \eqn{L_{sv}} for stratum \eqn{s}.}

\item{u}{List of length \eqn{S}. Each element \code{u[[s]]} is a numeric vector of right endpoints \eqn{U_{sv}} for stratum \eqn{s}.}

\item{u.star}{List of length \eqn{S}. Each element \code{u.star[[s]]} is a numeric vector of adjusted right endpoints \eqn{U^*_{sv}} for stratum \eqn{s}.}

\item{tau}{List of length \eqn{S}. Each element \code{tau[[s]]} is a numeric vector of sorted unique timepoints \eqn{\tau_{sr}} for stratum \eqn{s}.}

\item{x}{List of length \eqn{S}. Each element \code{x[[s]]} is a 3D array of covariates of dimension \eqn{n_s \times p \times \rho_s} for stratum \eqn{s}.}

\item{risk}{List of length \eqn{S}. Each element is a matrix of dimension \eqn{n_s \times \rho_s} indicating risk set membership at each timepoint in stratum \eqn{s}.}

\item{mapping}{Optional list. Required when clustering and stratification differ. Should contain:
\describe{
\item{\code{stratum}}{List of length \eqn{M}. Maps each observation in cluster \eqn{i} to its stratum index \eqn{s}.}
\item{\code{indiv}}{List of length \eqn{M}. Maps each observation in cluster \eqn{i} to its subject index \eqn{v} within stratum \eqn{s}.}
}}

\item{control}{List of control parameters for the EM algorithm. Should include:
\describe{
\item{\code{tol}}{Stopping criterion for convergence, based on the change in log-likelihood.}
\item{\code{maxit.var}}{Maximum number of EM iterations.}
}}
}
\value{
A list of length \eqn{S}, where each element is a numeric vector representing the estimated baseline hazard function for one stratum.
}
\description{
Returns the estimated baseline hazard function(s) that maximize the profile composite log-likelihood for a given fixed effect vector \eqn{\beta}.
}
\details{
This function uses a composite EM algorithm to iteratively estimate the baseline hazard function while holding the fixed effect coefficients \eqn{\beta} constant. It stops when the change in the composite log-likelihood is below \code{control$tol} or after \code{control$maxit.var} iterations.
}
\examples{
\dontrun{
lambda_hat <- argmax_profile(beta, l, u, u.star, tau, x, risk, control = list(tol = 1e-6, maxit.var = 50))
}

}
