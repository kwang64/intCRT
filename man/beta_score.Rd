% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Maximization_Step_EM_Algorithm.R
\name{beta_score}
\alias{beta_score}
\title{Evaluate Profile Composite Likelihood Score for All Strata}
\usage{
beta_score(beta, u.star, tau, x, w, risk, weights)
}
\arguments{
\item{beta}{Numeric. A \code{p}-dimensional vector of current fixed effect estimates.}

\item{u.star}{List of length \code{S}, where each element is a numeric vector of \code{u^*_sv} values for stratum \code{s}.}

\item{tau}{List of length \code{S}, where each element is a numeric vector of unique timepoints for stratum \code{s}.}

\item{x}{List of length \code{S}, where each element is a 3D array of covariates \code{x.s} for stratum \code{s}.}

\item{w}{List of length \code{S}, where each element is a matrix \code{w.s} containing expected counts from the E-step.}

\item{risk}{List of length \code{S}, where each element is a matrix indicating risk set membership at each timepoint in stratum \code{s}.}

\item{weights}{List of length \code{S}, where each element is a numeric vector of perturbation weights for stratum \code{s}.}

\item{u.s.star}{Numeric vector of length \code{n.s}, representing the right endpoints (\code{u^*_sv}) for individuals in stratum \code{s}.}

\item{tau.s}{Numeric vector of length \code{rho.s}, giving the sorted unique left and right endpoints for stratum \code{s}.}

\item{x.s}{3D array. Covariate array of dimension \code{n.s x p x rho.s}, where:
\itemize{
\item \code{x.s[v, , ]} returns a \code{p x rho.s} matrix for individual \code{v}
\item \code{x.s[, p, ]} returns an \code{n.s x rho.s} matrix for covariate \code{p}
\item \code{x.s[, , r]} returns an \code{n.s x p} matrix for timepoint \code{r}
}}

\item{w.s}{Matrix of dimension \code{n.s x rho.s}, containing the expected counts from the E-step (i.e., \code{w_{svr}}).}

\item{risk.vr}{Matrix of dimension \code{n.s x rho.s}, indicating risk set membership at each timepoint.}

\item{weights.s}{Numeric vector of length \code{n.s}, giving the perturbation weights for individuals in stratum \code{s}.}
}
\value{
A numeric vector of length \code{p}, representing the total score contributions for each covariate across all strata.

A numeric vector of length \code{p}, containing the score contributions for each covariate in the stratum.
}
\description{
Computes the composite score function for the fixed effects \code{beta} across all strata,
by summing the stratum-level profile composite likelihood score contributions.
}
\seealso{
\code{\link{x_bar_s}}, \code{\link{score}}, \code{\link{update_beta}}
}
\keyword{(gradient}
\keyword{Composite}
\keyword{Computes}
\keyword{Evaluate}
\keyword{Likelihood}
\keyword{Profile}
\keyword{Score}
\keyword{Single}
\keyword{Stratum}
\keyword{a}
\keyword{composite}
\keyword{for}
\keyword{function}
\keyword{in}
\keyword{internal}
\keyword{likelihood}
\keyword{log-likelihood)}
\keyword{of}
\keyword{profile}
\keyword{score}
\keyword{single}
\keyword{stratum.}
\keyword{the}
