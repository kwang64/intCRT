% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Composite Log-Likelihood Functions.R
\name{composite_i_2}
\alias{composite_i_2}
\title{Computes the composite log-likelihood contribution for a cluster (stratified and clustered data)}
\usage{
composite_i_2(beta, lambda, l, u, tau, x, stratum.i, indiv.i)
}
\arguments{
\item{beta}{Numeric vector. Current estimates of the fixed effect coefficients (length \eqn{p}).}

\item{lambda}{List of length \eqn{S}. Each element \eqn{lambda[[s]]} is the estimated baseline hazard vector for stratum \eqn{s}.}

\item{l}{List of length \eqn{S}. Each \eqn{l[[s]]} contains the left endpoints \eqn{L_{sv}} of the censoring intervals in stratum \eqn{s}.}

\item{u}{List of length \eqn{S}. Each \eqn{u[[s]]} contains the right endpoints \eqn{U_{sv}} of the censoring intervals in stratum \eqn{s}.}

\item{tau}{List of length \eqn{S}. Each \eqn{tau[[s]]} is the sorted vector of unique timepoints \eqn{\tau_{sr}} in stratum \eqn{s}.}

\item{x}{List of length \eqn{S}. Each \eqn{x[[s]]} is a 3D array of covariates for stratum \eqn{s}, where \eqn{x[[s]][v, , ]} returns a \eqn{p \times \rho_s} matrix.}

\item{stratum.i}{Numeric vector of length \eqn{n_i}. Maps subject \eqn{j} in cluster \eqn{i} to their stratum index \eqn{s}.}

\item{indiv.i}{Numeric vector of length \eqn{n_i}. Maps subject \eqn{j} in cluster \eqn{i} to their subject index \eqn{v} within stratum \eqn{s}.}
}
\value{
Numeric. The composite log-likelihood contribution from cluster \eqn{i}.
}
\description{
Calculates the independence composite log-likelihood contribution of cluster \eqn{i}, when the clustering and stratification variables differ,
under a marginal Cox regression model with interval-censored data.
}
\details{
The function iterates over each individual \eqn{j} in cluster \eqn{i}, determines their associated stratum and individual index,
extracts the corresponding data, and evaluates the individual composite log-likelihood contribution using \code{\link{composite_ij}}.
}
\keyword{internal}
