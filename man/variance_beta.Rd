% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Variance_Estimation_Functions.R
\name{variance_beta}
\alias{variance_beta}
\title{Compute the Covariance Matrix for Fixed Effect Estimates}
\usage{
variance_beta(beta, processed, mapping, control)
}
\arguments{
\item{beta}{Numeric vector of length \eqn{p}. Final fixed effect estimates.}

\item{processed}{List. Processed data object containing inputs used for point estimation, including covariates, event intervals, and risk sets.}

\item{mapping}{List or \code{NULL}. Optional mapping from cluster indexing to stratum indexing for robust variance estimation.
If \code{NULL}, clustering and stratification variables are assumed to be the same.}

\item{control}{List. Control parameters for the composite EM algorithm and variance estimation, including perturbation constants and tolerance.}
}
\value{
A \eqn{p \times p} numeric covariance matrix for the fixed effect estimates.
}
\description{
Calculates the estimated covariance matrix of the fixed effect estimators \code{beta}
based on the profile composite likelihood. Returns either the model-based covariance
matrix or the robust sandwich covariance matrix, depending on the data structure
and the presence of clustering and stratification mappings.
}
\details{
This function internally computes profile maximum likelihood estimators of the baseline hazard
under various perturbations of \code{beta} to approximate Hessian and variability matrices using
finite differences. It returns:
\itemize{
\item The inverse Hessian (model-based covariance) when data clustering matches stratification or only one stratum is present.
\item The robust sandwich covariance matrix (Godambe information) when clustering and stratification differ.
}

The perturbation size \code{h.n} is adaptively scaled by the sample size.
}
\seealso{
\code{\link{argmax_profile}}, \code{\link{H}}, \code{\link{J}}
}
